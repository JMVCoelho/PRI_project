one andrew graphics gems glassner got collegue minethink fiddled little bit make deal whatever bizarre problem working time known workspl spheres asg feb spl thu mar est include stdio h include math h define pi struct point_struct double x z static double radius static double xorg static double yorg static double zorg do_sphere r freq x z double r int freq double x double double z int pole double northy southy poley double rtheta rtheta ntheta ntheta magicangle double theta thetastart thisy den struct point_node pnp struct point_struct p p p p n n n n pt radius r xorg x yorg zorg z north pole magicangle pi northy radius sin magicangle southy radius sin magicangle pole pole pole pole poley radius thisy northy thetastart else poley radius thisy southy thetastart theta thetastart theta theta rtheta theta pi rtheta theta pi p x p poley p z p x radius cos rtheta p thisy p z radius sin rtheta p x radius cos rtheta p thisy p z radius sin rtheta pole make ring go way normals right pt x p x pt p pt z p z p x p x p p p z p z p x pt x p pt p z pt z den p x p x p p p z p z den sqrt den den radius den p x p p z den p x p x p p p z p z den sqrt den den radius den p x p p z den p x p x p p p z p z den sqrt den den radius den p x p p z subdivide_tri p p p freq body theta theta theta rtheta theta pi rtheta theta pi ntheta theta pi ntheta theta pi p x radius cos rtheta p northy p z radius sin rtheta p x radius cos rtheta p northy p z radius sin rtheta p x radius cos ntheta p southy p z radius sin ntheta p x radius cos ntheta p southy p z radius sin ntheta den p x p x p p p z p z den sqrt den den radius den p x p p z den p x p x p p p z p z den sqrt den den radius den p x p p z den p x p x p p p z p z den sqrt den den radius den p x p p z den p x p x p p p z p z den sqrt den den radius den p x p p z subdivide_tri p p p freq subdivide_tri p p p freq return define norm_pt v register double r sqrt v x v x v v v z v z v x r v r v z r subdivide_tri p p p struct point_struct p p p int struct point_struct n n n struct point_struct p p p double den p x p x p x p p p p z p z p z den p x p x p p p z p z den sqrt den den radius den p x p p z p x p x p x p p p p z p z p z den p x p x p p p z p z den sqrt den den radius den p x p p z p x p x p x p p p p z p z p z den p x p x p p p z p z den sqrt den den radius den p x p p z subdivide_tri p p p subdivide_tri p p p subdivide_tri p p p subdivide_tri p p p else n x p x n p n z p z norm_pt n n x p x n p n z p z norm_pt n n x p x n p n z p z norm_pt n nothing special poly printf f f f f f f n p x xorg p yorg p z zorg n x n n z printf f f f f f f n p x xorg p yorg p z zorg n x n n z printf f f f f f f n p x xorg p yorg p z zorg n x n n z return