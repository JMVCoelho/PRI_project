hi studying book unix desktop guide open lookexample winprop c demonstrate program wm_protocols property chapterrun show static text messages notice pop_upproblemthanks advance helpiop file winprop c shows set properties windowinclude x xatom h definition xa_atom include x intrinsic h include x stringdefs h include xol openlook h include xol statictext h include xol oblongbutt h include xol notice h file defines atoms _ol_ prefix id top level noticeshell widget static widget top_level notice_shell static widget make_notice static char message clients use properties communicate window managerexample illustrates open look application requests notification window manager certain events occurcommunication form clientmessage event application processes event handleratoms used inter client communication atom atom_wm_protocols atom_wm_delete_window atom_wm_save_yourself static void handle_wm_messages static void save_and_exit static void save_yourself static void pop_notice static void do_exit string hold comand line use responding wm_save_yourself protocol messagechar saved_cmdline void main argc argv int argc char argv widget w int save command line use responding wm_save_yourself protocol messagesprintf saved_cmdline argv argc argc strcat saved_cmdline argv strcat saved_cmdline create initialize top level widget top_level olinitialize argv ol_main null argc argv create statictext widget w xtvacreatemanagedwidget stext statictextwidgetclass top_level xtnstring message xtnwidth null create noticeshell widget later use make_notice top_level intern atoms atom_wm_protocols xinternatom xtdisplay w wm_protocols false atom_wm_delete_window xinternatom xtdisplay w wm_delete_window false atom_wm_save_yourself xinternatom xtdisplay w wm_save_yourself false add event handler process clientmessage events sent window manager xtaddeventhandler top_level noeventmask true handle_wm_messages null realize widgets start processing events xtrealizewidget top_level append properties wm_delete_window wm_save_yourself definition wm_protocols propertystep requires window id top level widgetwindow id valid widget realizedxchangeproperty xtdisplay top_level xtwindow top_level atom_wm_protocols xa_atom propmodeappend atom_wm_delete_window xchangeproperty xtdisplay top_level xtwindow top_level atom_wm_protocols xa_atom propmodeappend atom_wm_save_yourself xtmainloop static void handle_wm_messages w client_data p_event widget w xtpointer client_data xevent p_event p_event type clientmessage p_event xclient message_type atom_wm_protocols p_event xclient data l atom_wm_delete_window save_and_exit p_event xclient data l atom_wm_save_yourself save_yourself static void save_and_exit display notice giving user chance respond pop_notice top_level notice_shell static void save_yourself set wm_command property saved command linexchangeproperty xtdisplay top_level xtwindow top_level xa_wm_command xa_string propmodereplace saved_cmdline strlen saved_cmdline static widget make_notice parent widget parent widget w n_text n_control n_exit n_cancel create button provide callback pop notice w xtvacreatemanagedwidget quitbutton oblongbuttonwidgetclass parent xtnlabel exit null xtaddcallback w xtnselect pop_notice null create noticeshell widgetnote use xtvacreatepopupshell instead usual xtvacreatemanagedwidgetnotice_shell xtvacreatepopupshell quitnotice noticeshellwidgetclass w null get id text control area widgets noticeshellxtvagetvalues notice_shell xtntextarea n_text xtncontrolarea n_control null place message text area noticeshell xtvasetvalues n_text xtnstring please confirm exit programnull add buttons control area noticeshellbutton appropriate callbackn_exit xtvacreatemanagedwidget noticeexit oblongbuttonwidgetclass n_control xtnlabel exit null xtaddcallback n_exit xtnselect do_exit null n_cancel xtvacreatemanagedwidget noticecancel oblongbuttonwidgetclass n_control xtnlabel cancel xtndefault true null return w static void pop_notice w_emanate w_notice widget w_emanate w_notice xtvasetvalues w_notice xtnemanatewidget w_emanate null pop noticeshell widgetnoticeshell widget makes sure aplication waits user selects one buttons noticeshell control areaxtpopup w_notice xtgrabexclusive static void do_exit w call_data client_data widget w xtpointer call_data client_data xclosedisplay xtdisplay w exit